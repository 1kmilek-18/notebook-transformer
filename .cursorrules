## プロジェクトコンテキスト

このプロジェクトは、NotebookLMが生成するPDFスライドを、編集可能なPowerPoint（.pptx）に
高品質で変換するPythonツールです。

## 技術方針

- **Python 3.10+** を対象とし、型ヒント（type hints）を全関数に必ず付与する
- **PyMuPDF (fitz)** を使ったPDF解析で座標・フォント・色情報を正確に抽出する
- **python-pptx** を使い、テキストボックスや画像をスライド上の正確な座標に配置する
- 画像処理には **Pillow** と **OpenCV** を使用する
- **Pydantic** モデルでデータ構造を厳密に定義する
- **Claude API (Anthropic)** を活用してレイアウトの意味解釈を補完する

## コーディング規約

- 関数にはdocstringを付与する（Google style）
- エラーハンドリングは具体的な例外型を使い、ベアexceptは避ける
- ログ出力には `logging` モジュールを使用する（printは使わない）
- 座標系はPDF座標（ポイント単位、左上原点）を基準とし、PPTへの変換時にEMU変換する
- 設定値はハードコードせず、config または環境変数で管理する

## アーキテクチャ

```
src/
├── extractor/   # PDF解析 - PyMuPDFでテキスト・画像・座標を抽出
├── analyzer/    # AI分析 - LLMでレイアウト意味を解釈（タイトル/本文/箇条書き）
├── builder/     # PPTX構築 - python-pptxでスライドを再構築
├── utils/       # 共通ユーティリティ（座標変換、画像処理）
└── main.py      # CLIエントリーポイント
```

## 重要な注意点

- PDFの座標単位はポイント（1pt = 1/72インチ）
- PPTXの座標単位はEMU（1インチ = 914400 EMU）
- 変換式: EMU = pt * 914400 / 72 = pt * 12700
- NotebookLMのPDFスライドは横長（16:9）が多い
